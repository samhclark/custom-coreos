:::::: {.w-full .flex .flex-row .items-center .justify-between .py-1.5 .px-8 .text-garage-gray .bg-garage-orange .bg-opacity-20}
::: navbar-brand
[![](/images/garage-logo-horizontal.svg){.px-2 .transform .duration-150
.focus:bg-white .hover:bg-white .hover:shadow .rounded-lg
width="120"}](https://garagehq.deuxfleurs.fr){.hover:rounded-full
.hover:bg-white}
:::

![](data:image/svg+xml;base64,PHN2ZyBjbGFzcz0idy02IGgtNiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJjdXJyZW50Q29sb3IiIHZpZXdib3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMiIgZD0iTTQgNmgxNk00IDEyaDE2TTQgMThoNyIgLz48L3N2Zz4=){.w-6
.h-6}

:::: {#navMenu .hidden .py-4 .md:py-0 .z-40 .md:block .absolute .md:static .top-12 .left-0 .right-0 .navbar-menu .bg-gray-100 .shadow-md .md:shadow-none .md:bg-transparent}
::: {.flex .items-center .justify-center .space-x-1.5}
[Overview](https://garagehq.deuxfleurs.fr/){.font-semibold
.focus:bg-white .hover:bg-white .hover:shadow .px-2 .md:px-3 .py-1
.rounded-lg}
[Docs](https://garagehq.deuxfleurs.fr/documentation/){.font-semibold
.focus:bg-white .hover:bg-white .hover:shadow .px-2 .md:px-3 .py-1
.rounded-lg} [Blog](https://garagehq.deuxfleurs.fr/blog/){.font-semibold
.focus:bg-white .hover:bg-white .hover:shadow .px-2 .md:px-3 .py-1
.rounded-lg}
[![](data:image/svg+xml;base64,PHN2ZyBpZD0ibmF2LXNlYXJjaC1idG4taWNvbiIgY2xhc3M9InctNSBoLTUiIGZpbGw9Im5vbmUiIHN0cm9rZT0iY3VycmVudENvbG9yIiB2aWV3Ym94PSIwIDAgMjQgMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBkPSJNMjEgMjFsLTYtNm0yLTVhNyA3IDAgMTEtMTQgMCA3IDcgMCAwMTE0IDB6IiAvPgogICAgICAgICAgICAgICAgICAgIDwvc3ZnPg==){#nav-search-btn-icon
.w-5
.h-5}](javascript:openSearchModal() "Open Search (alt + S)"){#nav-search-btn
.focus:bg-white .hover:bg-white .hover:shadow .px-2 .py-2 .rounded-lg
type="button"}
[![](data:image/svg+xml;base64,PHN2ZyBjbGFzcz0idy02IGgtNiBhbmltYXRlLXB1bHNlIiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgdmlld2JveD0iMCAwIDI0IDI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBkPSJNNyAxNmE0IDQgMCAwMS0uODgtNy45MDNBNSA1IDAgMTExNS45IDZMMTYgNmE1IDUgMCAwMTEgOS45TTkgMTlsMyAzbTAgMGwzLTNtLTMgM1YxMCIgLz48L3N2Zz4=){.w-6
.h-6 .animate-pulse} [Download]{.hidden
.md:inline}](https://garagehq.deuxfleurs.fr/download/ "Garage releases"){.group
.flex .items-center .justify-center .space-x-1 .font-semibold .shadow
.hover:shadow .px-2 .py-1.5 .rounded .text-white .transition-all
.duration-500 .bg-gradient-to-tl .from-garage-orange .via-orange-500
.to-orange-300 .bg-size-200 .bg-pos-0 .hover:bg-pos-100}
[![](data:image/svg+xml;base64,PHN2ZyBjbGFzcz0idy02IGgtNiBhbmltYXRlLXB1bHNlIiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgdmlld2JveD0iMCAwIDk3IDk3IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGZpbGw9IiNGRkZGRkYiIGQ9Ik05Mi43MSw0NC40MDhMNTIuNTkxLDQuMjkxYy0yLjMxLTIuMzExLTYuMDU3LTIuMzExLTguMzY5LDBsLTguMzMsOC4zMzJMNDYuNDU5LDIzLjE5ICAgYzIuNDU2LTAuODMsNS4yNzItMC4yNzMsNy4yMjksMS42ODVjMS45NjksMS45NywyLjUyMSw0LjgxLDEuNjcsNy4yNzVsMTAuMTg2LDEwLjE4NWMyLjQ2NS0wLjg1LDUuMzA3LTAuMyw3LjI3NSwxLjY3MSAgIGMyLjc1LDIuNzUsMi43NSw3LjIwNiwwLDkuOTU4Yy0yLjc1MiwyLjc1MS03LjIwOCwyLjc1MS05Ljk2MSwwYy0yLjA2OC0yLjA3LTIuNTgtNS4xMS0xLjUzMS03LjY1OGwtOS41LTkuNDk5djI0Ljk5NyAgIGMwLjY3LDAuMzMyLDEuMzAzLDAuNzc0LDEuODYxLDEuMzMyYzIuNzUsMi43NSwyLjc1LDcuMjA2LDAsOS45NTljLTIuNzUsMi43NDktNy4yMDksMi43NDktOS45NTcsMGMtMi43NS0yLjc1NC0yLjc1LTcuMjEsMC05Ljk1OSAgIGMwLjY4LTAuNjc5LDEuNDY3LTEuMTkzLDIuMzA3LTEuNTM3VjM2LjM2OWMtMC44NC0wLjM0NC0xLjYyNS0wLjg1My0yLjMwNy0xLjUzN2MtMi4wODMtMi4wODItMi41ODQtNS4xNC0xLjUxNi03LjY5OCAgIEwzMS43OTgsMTYuNzE1TDQuMjg4LDQ0LjIyMmMtMi4zMTEsMi4zMTMtMi4zMTEsNi4wNiwwLDguMzcxbDQwLjEyMSw0MC4xMThjMi4zMSwyLjMxMSw2LjA1NiwyLjMxMSw4LjM2OSwwTDkyLjcxLDUyLjc3OSAgIEM5NS4wMjEsNTAuNDY4LDk1LjAyMSw0Ni43MTksOTIuNzEsNDQuNDA4eiIgLz48L3N2Zz4=){.w-6
.h-6
.animate-pulse}](https://git.deuxfleurs.fr/Deuxfleurs/garage "Check the source on Gitea"){.group
.flex .items-center .justify-center .space-x-1 .font-semibold .shadow
.hover:shadow .px-2 .py-1.5 .rounded .text-white .transition-all
.duration-500 .bg-gradient-to-tl .from-gray-400 .via-gray-500
.to-gray-400 .bg-size-200 .bg-pos-0 .hover:bg-pos-100 target="_blank"}
:::
::::
::::::

::::::::::::::::::: {#documentation-section .section .section .overflow-x-hidden}
::::::::::::: {.grid .grid-cols-1 .xl:grid-cols-5}
- [Quick
  Start](https://garagehq.deuxfleurs.fr/documentation/quick-start/){.bg-white
  .border .border-garage-orange .block .p-1 .rounded-r .rounded-tl
  .font-semibold .text-gray-800}
- [Cookbook](https://garagehq.deuxfleurs.fr/documentation/cookbook/){.bg-white
  .border .border-garage-orange .block .p-1 .rounded-r .rounded-tl
  .font-semibold .text-gray-800} ☐
  ![](data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iYXJyb3cgdy02IGgtNiB0ZXh0LWdhcmFnZS1ncmF5IGdyb3VwLWhvdmVyOnRleHQtZ2FyYWdlLW9yYW5nZSB0cmFuc2Zvcm0gcm90YXRlLTkwIiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgdmlld2JveD0iMCAwIDI0IDI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBkPSJNOSA1bDcgNy03IDciIC8+PC9zdmc+){.arrow
  .w-6 .h-6 .text-garage-gray .group-hover:text-garage-orange .transform
  .rotate-90}
  - [Deployment on a
    cluster](https://garagehq.deuxfleurs.fr/documentation/cookbook/real-world/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Compiling Garage from
    source](https://garagehq.deuxfleurs.fr/documentation/cookbook/from-source/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Binary
    packages](https://garagehq.deuxfleurs.fr/documentation/cookbook/binary-packages/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Starting Garage with
    systemd](https://garagehq.deuxfleurs.fr/documentation/cookbook/systemd/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Configuring a gateway
    node](https://garagehq.deuxfleurs.fr/documentation/cookbook/gateways/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Exposing buckets as
    websites](https://garagehq.deuxfleurs.fr/documentation/cookbook/exposing-websites/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Configuring a reverse
    proxy](https://garagehq.deuxfleurs.fr/documentation/cookbook/reverse-proxy/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Deploying on
    Kubernetes](https://garagehq.deuxfleurs.fr/documentation/cookbook/kubernetes/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Deploying with
    Ansible](https://garagehq.deuxfleurs.fr/documentation/cookbook/ansible/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Monitoring
    Garage](https://garagehq.deuxfleurs.fr/documentation/cookbook/monitoring/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Encryption](https://garagehq.deuxfleurs.fr/documentation/cookbook/encryption/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
- [Existing
  integrations](https://garagehq.deuxfleurs.fr/documentation/connect/){.bg-white
  .border .border-garage-orange .block .p-1 .rounded-r .rounded-tl
  .font-semibold .text-gray-800} ☐
  ![](data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iYXJyb3cgdy02IGgtNiB0ZXh0LWdhcmFnZS1ncmF5IGdyb3VwLWhvdmVyOnRleHQtZ2FyYWdlLW9yYW5nZSB0cmFuc2Zvcm0gcm90YXRlLTkwIiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgdmlld2JveD0iMCAwIDI0IDI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBkPSJNOSA1bDcgNy03IDciIC8+PC9zdmc+){.arrow
  .w-6 .h-6 .text-garage-gray .group-hover:text-garage-orange .transform
  .rotate-90}
  - [Apps (Nextcloud,
    Peertube\...)](https://garagehq.deuxfleurs.fr/documentation/connect/apps/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Websites (Hugo, Jekyll,
    Publii\...)](https://garagehq.deuxfleurs.fr/documentation/connect/websites/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Repositories (Docker, Nix,
    Git\...)](https://garagehq.deuxfleurs.fr/documentation/connect/repositories/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Browsing
    tools](https://garagehq.deuxfleurs.fr/documentation/connect/cli/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Backups (restic,
    duplicity\...)](https://garagehq.deuxfleurs.fr/documentation/connect/backup/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [FUSE (s3fs, goofys,
    s3backer\...)](https://garagehq.deuxfleurs.fr/documentation/connect/fs/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Observability](https://garagehq.deuxfleurs.fr/documentation/connect/observability/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
- [Build your own
  app](https://garagehq.deuxfleurs.fr/documentation/build/){.bg-white
  .border .border-garage-orange .block .p-1 .rounded-r .rounded-tl
  .font-semibold .text-gray-800} ☐
  ![](data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iYXJyb3cgdy02IGgtNiB0ZXh0LWdhcmFnZS1ncmF5IGdyb3VwLWhvdmVyOnRleHQtZ2FyYWdlLW9yYW5nZSB0cmFuc2Zvcm0gcm90YXRlLTkwIiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgdmlld2JveD0iMCAwIDI0IDI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBkPSJNOSA1bDcgNy03IDciIC8+PC9zdmc+){.arrow
  .w-6 .h-6 .text-garage-gray .group-hover:text-garage-orange .transform
  .rotate-90}
  - [Javascript](https://garagehq.deuxfleurs.fr/documentation/build/javascript/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Python](https://garagehq.deuxfleurs.fr/documentation/build/python/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Golang](https://garagehq.deuxfleurs.fr/documentation/build/golang/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Rust](https://garagehq.deuxfleurs.fr/documentation/build/rust/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Others](https://garagehq.deuxfleurs.fr/documentation/build/others/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
- [Operations &
  Maintenance](https://garagehq.deuxfleurs.fr/documentation/operations/){.bg-white
  .border .border-garage-orange .block .p-1 .rounded-r .rounded-tl
  .font-semibold .text-gray-800} ☐
  ![](data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iYXJyb3cgdy02IGgtNiB0ZXh0LWdhcmFnZS1ncmF5IGdyb3VwLWhvdmVyOnRleHQtZ2FyYWdlLW9yYW5nZSB0cmFuc2Zvcm0gcm90YXRlLTkwIiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgdmlld2JveD0iMCAwIDI0IDI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBkPSJNOSA1bDcgNy03IDciIC8+PC9zdmc+){.arrow
  .w-6 .h-6 .text-garage-gray .group-hover:text-garage-orange .transform
  .rotate-90}
  - [Upgrading
    Garage](https://garagehq.deuxfleurs.fr/documentation/operations/upgrading/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Multi-HDD
    support](https://garagehq.deuxfleurs.fr/documentation/operations/multi-hdd/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Cluster layout
    management](https://garagehq.deuxfleurs.fr/documentation/operations/layout/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Durability &
    Repairs](https://garagehq.deuxfleurs.fr/documentation/operations/durability-repairs/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Recovering from
    failures](https://garagehq.deuxfleurs.fr/documentation/operations/recovering/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
- [Reference
  Manual](https://garagehq.deuxfleurs.fr/documentation/reference-manual/){.bg-white
  .border .border-garage-orange .block .p-1 .rounded-r .rounded-tl
  .font-semibold .text-gray-800} ☐
  ![](data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iYXJyb3cgdy02IGgtNiB0ZXh0LWdhcmFnZS1ncmF5IGdyb3VwLWhvdmVyOnRleHQtZ2FyYWdlLW9yYW5nZSB0cmFuc2Zvcm0gcm90YXRlLTkwIiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgdmlld2JveD0iMCAwIDI0IDI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBkPSJNOSA1bDcgNy03IDciIC8+PC9zdmc+){.arrow
  .w-6 .h-6 .text-garage-gray .group-hover:text-garage-orange .transform
  .rotate-90}
  - [List of Garage
    features](https://garagehq.deuxfleurs.fr/documentation/reference-manual/features/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Configuration file
    format](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20 .activePage
    .text-garage-orange .font-semibold .border-opacity-100
    .border-garage-orange}
  - [Garage
    CLI](https://garagehq.deuxfleurs.fr/documentation/reference-manual/cli/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Administration
    API](https://garagehq.deuxfleurs.fr/documentation/reference-manual/admin-api/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Monitoring](https://garagehq.deuxfleurs.fr/documentation/reference-manual/monitoring/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [S3 Compatibility
    status](https://garagehq.deuxfleurs.fr/documentation/reference-manual/s3-compatibility/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [K2V](https://garagehq.deuxfleurs.fr/documentation/reference-manual/k2v/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
- [Design](https://garagehq.deuxfleurs.fr/documentation/design/){.bg-white
  .border .border-garage-orange .block .p-1 .rounded-r .rounded-tl
  .font-semibold .text-gray-800} ☐
  ![](data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iYXJyb3cgdy02IGgtNiB0ZXh0LWdhcmFnZS1ncmF5IGdyb3VwLWhvdmVyOnRleHQtZ2FyYWdlLW9yYW5nZSB0cmFuc2Zvcm0gcm90YXRlLTkwIiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgdmlld2JveD0iMCAwIDI0IDI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBkPSJNOSA1bDcgNy03IDciIC8+PC9zdmc+){.arrow
  .w-6 .h-6 .text-garage-gray .group-hover:text-garage-orange .transform
  .rotate-90}
  - [Goals and use
    cases](https://garagehq.deuxfleurs.fr/documentation/design/goals/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Internals](https://garagehq.deuxfleurs.fr/documentation/design/internals/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Benchmarks](https://garagehq.deuxfleurs.fr/documentation/design/benchmarks/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Related
    work](https://garagehq.deuxfleurs.fr/documentation/design/related-work/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
- [Development](https://garagehq.deuxfleurs.fr/documentation/development/){.bg-white
  .border .border-garage-orange .block .p-1 .rounded-r .rounded-tl
  .font-semibold .text-gray-800} ☐
  ![](data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iYXJyb3cgdy02IGgtNiB0ZXh0LWdhcmFnZS1ncmF5IGdyb3VwLWhvdmVyOnRleHQtZ2FyYWdlLW9yYW5nZSB0cmFuc2Zvcm0gcm90YXRlLTkwIiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgdmlld2JveD0iMCAwIDI0IDI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBkPSJNOSA1bDcgNy03IDciIC8+PC9zdmc+){.arrow
  .w-6 .h-6 .text-garage-gray .group-hover:text-garage-orange .transform
  .rotate-90}
  - [Setup your
    environment](https://garagehq.deuxfleurs.fr/documentation/development/devenv/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Development
    scripts](https://garagehq.deuxfleurs.fr/documentation/development/scripts/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Release
    process](https://garagehq.deuxfleurs.fr/documentation/development/release-process/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Miscellaneous
    notes](https://garagehq.deuxfleurs.fr/documentation/development/miscellaneous-notes/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
- [Working
  Documents](https://garagehq.deuxfleurs.fr/documentation/working-documents/){.bg-white
  .border .border-garage-orange .block .p-1 .rounded-r .rounded-tl
  .font-semibold .text-gray-800} ☐
  ![](data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iYXJyb3cgdy02IGgtNiB0ZXh0LWdhcmFnZS1ncmF5IGdyb3VwLWhvdmVyOnRleHQtZ2FyYWdlLW9yYW5nZSB0cmFuc2Zvcm0gcm90YXRlLTkwIiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgdmlld2JveD0iMCAwIDI0IDI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBkPSJNOSA1bDcgNy03IDciIC8+PC9zdmc+){.arrow
  .w-6 .h-6 .text-garage-gray .group-hover:text-garage-orange .transform
  .rotate-90}
  - [S3 compatibility
    target](https://garagehq.deuxfleurs.fr/documentation/working-documents/compatibility-target/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Migrating from 1.0 to
    2.0](https://garagehq.deuxfleurs.fr/documentation/working-documents/migration-2/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Migrating from 0.9 to
    1.0](https://garagehq.deuxfleurs.fr/documentation/working-documents/migration-1/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Migrating from 0.8 to
    0.9](https://garagehq.deuxfleurs.fr/documentation/working-documents/migration-09/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Migrating from 0.7 to
    0.8](https://garagehq.deuxfleurs.fr/documentation/working-documents/migration-08/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Migrating from 0.6 to
    0.7](https://garagehq.deuxfleurs.fr/documentation/working-documents/migration-07/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Migrating from 0.5 to
    0.6](https://garagehq.deuxfleurs.fr/documentation/working-documents/migration-06/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Migrating from 0.3 to
    0.4](https://garagehq.deuxfleurs.fr/documentation/working-documents/migration-04/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Testing
    strategy](https://garagehq.deuxfleurs.fr/documentation/working-documents/testing-strategy/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Design draft
    (obsolete)](https://garagehq.deuxfleurs.fr/documentation/working-documents/design-draft/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}
  - [Load balancing data
    (obsolete)](https://garagehq.deuxfleurs.fr/documentation/working-documents/load-balancing/){.docPage
    .block .pl-2 .py-1 .border-l-4 .rounded-r .border-opacity-0
    .hover:bg-garage-orange .hover:bg-opacity-20}

:::::: {.col-span-full .xl:col-span-3 style="min-height:85vh;"}
:::: {.flex .flex-col .mb-10 .bg-gray-100 .rounded-r .shadow-sm .w-full .xl:w-max}
::: {.flex .flex-col .border-l-4 .border-garage-orange .py-2 .px-4 .relative}
# Configuration file format {#configuration-file-format .title .leading-10 .text-xl .lg:text-2xl .xl:text-3xl .text-garage-orange .font-semibold}

![](data:image/svg+xml;base64,PHN2ZyBjbGFzcz0idy00IGgtNCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJjdXJyZW50Q29sb3IiIHZpZXdib3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMiIgZD0iTTEyIDh2NGwzIDNtNi0zYTkgOSAwIDExLTE4IDAgOSA5IDAgMDExOCAweiIgLz48L3N2Zz4=){.w-4
.h-4} 26 min
:::
::::

::: {.page-content .max-w-4xl}
## Full example

Here is an example `garage.toml` configuration file that illustrates all
of the possible options:

``` {.language-toml data-lang="toml" style="background-color:#2b303b;color:#c0c5ce;"}
replication_factor = 3
consistency_mode = "consistent"

metadata_dir = "/var/lib/garage/meta"
data_dir = "/var/lib/garage/data"
metadata_snapshots_dir = "/var/lib/garage/snapshots"
metadata_fsync = true
data_fsync = false
disable_scrub = false
use_local_tz = false
metadata_auto_snapshot_interval = "6h"

db_engine = "lmdb"

block_size = "1M"
block_ram_buffer_max = "256MiB"
block_max_concurrent_reads = 16

lmdb_map_size = "1T"

compression_level = 1

rpc_secret = "4425f5c26c5e11581d3223904324dcb5b5d5dfb14e5e7f35e38c595424f5f1e6"
rpc_bind_addr = "[::]:3901"
rpc_bind_outgoing = false
rpc_public_addr = "[fc00:1::1]:3901"
# or set rpc_public_adr_subnet to filter down autodiscovery to a subnet:
# rpc_public_addr_subnet = "2001:0db8:f00:b00:/64"


allow_world_readable_secrets = false

bootstrap_peers = [
    "563e1ac825ee3323aa441e72c26d1030d6d4414aeb3dd25287c531e7fc2bc95d@[fc00:1::1]:3901",
    "86f0f26ae4afbd59aaf9cfb059eefac844951efd5b8caeec0d53f4ed6c85f332@[fc00:1::2]:3901",
    "681456ab91350f92242e80a531a3ec9392cb7c974f72640112f90a600d7921a4@[fc00:B::1]:3901",
    "212fd62eeaca72c122b45a7f4fa0f55e012aa5e24ac384a72a3016413fa724ff@[fc00:F::1]:3901",
]

allow_punycode = false

[consul_discovery]
api = "catalog"
consul_http_addr = "http://127.0.0.1:8500"
service_name = "garage-daemon"
ca_cert = "/etc/consul/consul-ca.crt"
client_cert = "/etc/consul/consul-client.crt"
client_key = "/etc/consul/consul-key.crt"
# for `agent` API mode, unset client_cert and client_key, and optionally enable `token`
# token = "abcdef-01234-56789"
tls_skip_verify = false
tags = [ "dns-enabled" ]
meta = { dns-acl = "allow trusted" }


[kubernetes_discovery]
namespace = "garage"
service_name = "garage-daemon"
skip_crd = false


[s3_api]
api_bind_addr = "[::]:3900"
s3_region = "garage"
root_domain = ".s3.garage"

[s3_web]
bind_addr = "[::]:3902"
root_domain = ".web.garage"
add_host_to_metrics = true

[admin]
api_bind_addr = "0.0.0.0:3903"
metrics_token = "BCAdFjoa9G0KJR0WXnHHm7fs1ZAbfpI8iIZ+Z/a2NgI="
metrics_require_token = true
admin_token = "UkLeGWEvHnXBqnueR3ISEMWpOnm40jH2tM2HnnL/0F4="
trace_sink = "http://localhost:4317"
```

The following gives details about each available configuration option.

## Available configuration options

### Index

[Environment
variables](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#env_variables).

Top-level configuration options, in alphabetical order:
[`allow_punycode`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#allow_punycode),
[`allow_world_readable_secrets`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#allow_world_readable_secrets),
[`block_max_concurrent_reads`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#block_max_concurrent_reads),
[`block_ram_buffer_max`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#block_ram_buffer_max),
[`block_size`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#block_size),
[`bootstrap_peers`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#bootstrap_peers),
[`compression_level`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#compression_level),
[`consistency_mode`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#consistency_mode),
[`data_dir`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#data_dir),
[`data_fsync`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#data_fsync),
[`db_engine`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#db_engine),
[`disable_scrub`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#disable_scrub),
[`lmdb_map_size`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#lmdb_map_size),
[`metadata_auto_snapshot_interval`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#metadata_auto_snapshot_interval),
[`metadata_dir`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#metadata_dir),
[`metadata_fsync`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#metadata_fsync),
[`metadata_snapshots_dir`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#metadata_snapshots_dir),
[`replication_factor`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#replication_factor),
[`rpc_bind_addr`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#rpc_bind_addr),
[`rpc_bind_outgoing`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#rpc_bind_outgoing),
[`rpc_public_addr`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#rpc_public_addr),
[`rpc_public_addr_subnet`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#rpc_public_addr_subnet)
[`rpc_secret`/`rpc_secret_file`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#rpc_secret),
[`use_local_tz`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#use_local_tz).

The `[consul_discovery]` section:
[`api`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#consul_api),
[`ca_cert`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#consul_ca_cert),
[`client_cert`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#consul_client_cert_and_key),
[`client_key`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#consul_client_cert_and_key),
[`consul_http_addr`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#consul_http_addr),
[`meta`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#consul_tags_and_meta),
[`service_name`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#consul_service_name),
[`tags`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#consul_tags_and_meta),
[`tls_skip_verify`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#consul_tls_skip_verify),
[`token`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#consul_token).

The `[kubernetes_discovery]` section:
[`namespace`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#kube_namespace),
[`service_name`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#kube_service_name),
[`skip_crd`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#kube_skip_crd).

The `[s3_api]` section:
[`api_bind_addr`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#s3_api_bind_addr),
[`root_domain`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#s3_root_domain),
[`s3_region`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#s3_region).

The `[s3_web]` section:
[`add_host_to_metrics`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#web_add_host_to_metrics),
[`bind_addr`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#web_bind_addr),
[`root_domain`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#web_root_domain).

The `[admin]` section:
[`api_bind_addr`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#admin_api_bind_addr),
[`metrics_require_token`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#admin_metrics_require_token),
[`metrics_token`/`metrics_token_file`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#admin_metrics_token),
[`admin_token`/`admin_token_file`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#admin_token),
[`trace_sink`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#admin_trace_sink),

### Environment variables {#env_variables}

The following configuration parameters must be specified as environment
variables, they do not exist in the configuration file:

- `GARAGE_LOG_TO_SYSLOG` (since `v0.9.4`): set this to `1` or `true` to
  make the Garage daemon send its logs to `syslog` (using the libc
  `syslog` function) instead of printing to stderr.

- `GARAGE_LOG_TO_JOURNALD` (since `v1.2.0`): set this to `1` or `true`
  to make the Garage daemon send its logs to `journald` (using the
  native protocol of `systemd-journald`) instead of printing to stderr.

The following environment variables can be used to override the
corresponding values in the configuration file:

- [`GARAGE_ALLOW_WORLD_READABLE_SECRETS`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#allow_world_readable_secrets)
- [`GARAGE_RPC_SECRET` and
  `GARAGE_RPC_SECRET_FILE`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#rpc_secret)
- [`GARAGE_ADMIN_TOKEN` and
  `GARAGE_ADMIN_TOKEN_FILE`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#admin_token)
- [`GARAGE_METRICS_TOKEN` and
  `GARAGE_METRICS_TOKEN`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#admin_metrics_token)

### Top-level configuration options

#### `replication_factor` (since `v1.0.0`) {#replication_factor}

The replication factor can be any positive integer smaller or equal the
node count in your cluster. The chosen replication factor has a big
impact on the cluster\'s failure tolerancy and performance
characteristics.

- `1`: data stored on Garage is stored on a single node. There is no
  redundancy, and data will be unavailable as soon as one node fails or
  its network is disconnected. Do not use this for anything else than
  test deployments.

- `2`: data stored on Garage will be stored on two different nodes, if
  possible in different zones. Garage tolerates one node failure, or
  several nodes failing but all in a single zone (in a deployment with
  at least two zones), before losing data. Data remains available in
  read-only mode when one node is down, but write operations will fail.

- `3`: data stored on Garage will be stored on three different nodes, if
  possible each in a different zones. Garage tolerates two node failure,
  or several node failures but in no more than two zones (in a
  deployment with at least three zones), before losing data. As long as
  only a single node fails, or node failures are only in a single zone,
  reading and writing data to Garage can continue normally.

- `5`, `7`, \...: When setting the replication factor above 3, it is
  most useful to choose an uneven value, since for every two copies
  added, one more node can fail before losing the ability to write and
  read to the cluster.

Note that in modes `2` and `3`, if at least the same number of zones are
available, an arbitrary number of failures in any given zone is
tolerated as copies of data will be spread over several zones.

**Make sure `replication_factor` is the same in the configuration files
of all nodes. Never run a Garage cluster where that is not the case.**

It is technically possible to change the replication factor although
it\'s a dangerous operation that is not officially supported. This
requires you to delete the existing cluster layout and create a new
layout from scratch, meaning that a full rebalancing of your cluster\'s
data will be needed. To do it, shut down your cluster entirely, delete
the `custer_layout` files in the meta directories of all your nodes,
update all your configuration files with the new `replication_factor`
parameter, restart your cluster, and then create a new layout with all
the nodes you want to keep. Rebalancing data will take some time, and
data might temporarily appear unavailable to your users. It is
recommended to shut down public access to the cluster while rebalancing
is in progress. In theory, no data should be lost as rebalancing is a
routine operation for Garage, although we cannot guarantee you that
everything will go right in such an extreme scenario.

#### `consistency_mode` (since `v1.0.0`) {#consistency_mode}

The consistency mode setting determines the read and write behaviour of
your cluster.

- `consistent`: The default setting. This is what the paragraph above
  describes. The read and write quorum will be determined so that
  read-after-write consistency is guaranteed.
- `degraded`: Lowers the read quorum to `1`, to allow you to read data
  from your cluster when several nodes (or nodes in several zones) are
  unavailable. In this mode, Garage does not provide read-after-write
  consistency anymore. The write quorum stays the same as in the
  `consistent` mode, ensuring that data successfully written to Garage
  is stored on multiple nodes (depending the replication factor).
- `dangerous`: This mode lowers both the read and write quorums to `1`,
  to allow you to both read and write to your cluster when several nodes
  (or nodes in several zones) are unavailable. It is the least
  consistent mode of operation proposed by Garage, and also one that
  should probably never be used.

Changing the `consistency_mode` between modes while leaving the
`replication_factor` untouched (e.g. setting your node\'s
`consistency_mode` to `degraded` when it was previously unset, or from
`dangerous` to `consistent`), can be done easily by just changing the
`consistency_mode` parameter in your config files and restarting all
your Garage nodes.

The consistency mode can be used together with various replication
factors, to achieve a wide range of read and write characteristics. Some
examples:

- Replication factor `2`, consistency mode `degraded`: While this mode
  technically exists, its properties are the same as with consistency
  mode `consistent`, since the read quorum with replication factor `2`,
  consistency mode `consistent` is already 1.

- Replication factor `2`, consistency mode `dangerous`: written objects
  are written to the second replica asynchronously. This means that
  Garage will return `200 OK` to a PutObject request before the second
  copy is fully written (or even before it even starts being written).
  This means that data can more easily be lost if the node crashes
  before a second copy can be completed. This also means that written
  objects might not be visible immediately in read operations. In other
  words, this configuration severely breaks the consistency and
  durability guarantees of standard Garage cluster operation. Benefits
  of this configuration: you can still write to your cluster when one
  node is unavailable.

The quorums associated with each replication mode are described below:

  `consistency_mode`   `replication_factor`   Write quorum   Read quorum   Read-after-write consistency?
  -------------------- ---------------------- -------------- ------------- -------------------------------
  `consistent`         1                      1              1             yes
  `consistent`         2                      2              1             yes
  `dangerous`          2                      1              1             NO
  `consistent`         3                      2              2             yes
  `degraded`           3                      2              1             NO
  `dangerous`          3                      1              1             NO

#### `metadata_dir`

The directory in which Garage will store its metadata. This contains the
node identifier, the network configuration and the peer list, the list
of buckets and keys as well as the index of all objects, object version
and object blocks.

Store this folder on a fast SSD drive if possible to maximize Garage\'s
performance.

#### `data_dir`

The directory in which Garage will store the data blocks of objects.
This folder can be placed on an HDD. The space available for `data_dir`
should be counted to determine a node\'s capacity when [adding it to the
cluster
layout](https://garagehq.deuxfleurs.fr/documentation/cookbook/real-world/).

Since `v0.9.0`, Garage supports multiple data directories with the
following syntax:

``` {.language-toml data-lang="toml" style="background-color:#2b303b;color:#c0c5ce;"}
data_dir = [
    { path = "/path/to/old_data", read_only = true },
    { path = "/path/to/new_hdd1", capacity = "2T" },
    { path = "/path/to/new_hdd2", capacity = "4T" },
]
```

See [the dedicated documentation
page](https://garagehq.deuxfleurs.fr/documentation/operations/multi-hdd/)
on how to operate Garage in such a setup.

#### `metadata_snapshots_dir` (since `v1.1.0`) {#metadata_snapshots_dir}

The directory in which Garage will store metadata snapshots when it
performs a snapshot of the metadata database, either when instructed to
do so from a RPC call or regularly through
[`metadata_auto_snapshot_interval`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#metadata_auto_snapshot_interval).

By default, Garage will store snapshots into a `snapshots/` subdirectory
of
[`metadata_dir`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#metadata_dir).
This might quickly fill up your metadata storage space if you use
snapshots, because Garage will need up to 4x the space of the existing
metadata database: each snapshot requires roughly as much space as the
original database, and Garage temporarily needs to store up to three
different snapshots before it cleans up the oldest snapshot to go back
to two stored snapshots.

To prevent filling your disk, you might to change this setting to a
directory with ample available space, e.g. on the same storage space as
[`data_dir`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#data_dir).

#### `db_engine` (since `v0.8.0`) {#db_engine}

Since `v0.8.0`, Garage can use alternative storage backends as follows:

  DB engine                                                                                                                                           `db_engine` value   Database path
  --------------------------------------------------------------------------------------------------------------------------------------------------- ------------------- ----------------------------
  [LMDB](https://www.symas.com/lmdb){rel="noopener nofollow noreferrer" target="_blank"} (since `v0.8.0`, default since `v0.9.0`)                     `"lmdb"`            `<metadata_dir>/db.lmdb/`
  [Sqlite](https://sqlite.org){rel="noopener nofollow noreferrer" target="_blank"} (since `v0.8.0`)                                                   `"sqlite"`          `<metadata_dir>/db.sqlite`
  [Fjall](https://github.com/fjall-rs/fjall){rel="noopener nofollow noreferrer" target="_blank"} (**experimental support** since `v1.3.0`/`v2.1.0`)   `"fjall"`           `<metadata_dir>/db.fjall/`
  [Sled](https://sled.rs){rel="noopener nofollow noreferrer" target="_blank"} (old default, removed since `v1.0`)                                     `"sled"`            `<metadata_dir>/db/`

Sled was supported until Garage v0.9.x, and was removed in Garage v1.0.
You can still use an older binary of Garage (e.g. v0.9.4) to migrate old
Sled metadata databases to another engine.

Performance characteristics of the different DB engines are as follows:

- **LMDB:** the recommended database engine for high-performance
  distributed clusters with `replication_factor` ≥ 2. LMDB works well,
  but is known to have the following limitations:

  - LMDB is prone to database corruption after an unclean shutdown (e.g.
    a process kill or a power outage). It is recommended to configure
    [`metadata_auto_snapshot_interval`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#metadata_auto_snapshot_interval)
    to be able to easily recover from this situation. With
    `replication_factor` ≥ 2, metadata can also be reconstructed from
    remote nodes upon corruption (see [Recovering from
    failures](https://garagehq.deuxfleurs.fr/documentation/operations/recovering/#corrupted_meta)).

  - The data format of LMDB is not portable between architectures, so
    for instance the Garage database of an x86-64 node cannot be moved
    to an ARM64 node.

  - While LMDB can technically be used on 32-bit systems, this will
    limit your node to very small database sizes due to how LMDB works;
    it is therefore not recommended.

  - Keys in LMDB are limited to 511 bytes. This limit translates to
    limits on object keys in S3 and sort keys in K2V that are limted to
    479 bytes.

- **Sqlite:** Garage supports Sqlite as an alternative storage backend
  for metadata, which does not have the issues listed above for LMDB.
  Sqlite is slower than LMDB, so it is not the best choice for
  high-performance storage clusters.

- **Fjall:** a storage engine based on LSM trees, which theoretically
  allow for higher write throughput than other storage engines that are
  based on B-trees. Using Fjall could potentially improve Garage\'s
  performance significantly in write-heavy workloads. **Support for
  Fjall is experimental at this point**, we have added it to Garage for
  evaluation purposes only. **Use it only with test data, and report any
  issues to our bug tracker. Do not use it for production workloads.**

It is possible to convert Garage\'s metadata directory from one format
to another using the `garage convert-db` command, which should be used
as follows:

``` {style="background-color:#2b303b;color:#c0c5ce;"}
garage convert-db -a <input db engine> -i <input db path> \
                  -b <output db engine> -o <output db path>
```

Make sure to specify the full database path as presented in the table
above (third colummn), and not just the path to the metadata directory.

#### `metadata_fsync`

Whether to enable synchronous mode for the database engine or not. This
is disabled (`false`) by default.

This reduces the risk of metadata corruption in case of power failures,
at the cost of a significant drop in write performance, as Garage will
have to pause to sync data to disk much more often (several times for
API calls such as PutObject).

Using this option reduces the risk of simultaneous metadata corruption
on several cluster nodes, which could lead to data loss.

If multi-site replication is used, this option is most likely not
necessary, as it is extremely unlikely that two nodes in different
locations will have a power failure at the exact same time.

(Metadata corruption on a single node is not an issue, the corrupted
data file can always be deleted and reconstructed from the other nodes
in the cluster.)

Here is how this option impacts the different database engines:

  Database   `metadata_fsync = false` (default)   `metadata_fsync = true`
  ---------- ------------------------------------ -------------------------------
  Sqlite     `PRAGMA synchronous = OFF`           `PRAGMA synchronous = NORMAL`
  LMDB       `MDB_NOMETASYNC` + `MDB_NOSYNC`      `MDB_NOMETASYNC`
  Fjall      default options                      not supported

Note that the Sqlite database is always ran in `WAL` mode
(`PRAGMA journal_mode = WAL`).

#### `data_fsync`

Whether to `fsync` data blocks and their containing directory after they
are saved to disk. This is disabled (`false`) by default.

This might reduce the risk that a data block is lost in rare situations
such as simultaneous node losing power, at the cost of a moderate drop
in write performance.

Similarly to `metatada_fsync`, this is likely not necessary if
geographical replication is used.

#### `metadata_auto_snapshot_interval` (since `v0.9.4`) {#metadata_auto_snapshot_interval}

If this value is set, Garage will automatically take a snapshot of the
metadata DB file at a regular interval and save it in the metadata
directory, or in
[`metadata_snapshots_dir`](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#metadata_snapshots_dir)
if it is set. This parameter can take any duration string that can be
parsed by the
[`parse_duration`](https://docs.rs/parse_duration/latest/parse_duration/#syntax){rel="noopener nofollow noreferrer"
target="_blank"} crate.

Snapshots can allow to recover from situations where the metadata DB
file is corrupted, for instance after an unclean shutdown. See [this
page](https://garagehq.deuxfleurs.fr/documentation/operations/recovering/#corrupted_meta)
for details. Garage keeps only the two most recent snapshots of the
metadata DB and deletes older ones automatically. You can also create
metadata snapshots manually at any point using the
`garage meta snapshot` command.

Using snapshots created by Garage is the best option to make snapshots
of your node\'s metadata for potential recovery, as they are guaranteed
to be clean and consistent, contrarily to filesystem-level snapshots
that may be taken while some writes are in-flight and thus might be
corrupted.

Note that taking a metadata snapshot is a relatively intensive operation
as the entire data file is copied. A snapshot being taken might have
performance impacts on the Garage node while it is running. If the
cluster is under heavy write load when a snapshot operation is running,
this might also cause the database file to grow in size significantly as
pages cannot be recycled easily.

#### `disable_scrub`

By default, Garage runs a scrub of the data directory approximately once
per month, with a random delay to avoid all nodes running at the same
time. When it scrubs the data directory, Garage will read all of the
data files stored on disk to check their integrity, and will rebuild any
data files that it finds corrupted, using the remaining valid copies
stored on other nodes. See [this
page](https://garagehq.deuxfleurs.fr/documentation/operations/durability-repairs/#scrub)
for details.

Set the `disable_scrub` configuration value to `true` if you don\'t need
Garage to scrub the data directory, for instance if you are already
scrubbing at the filesystem level. Note that in this case, if you find a
corrupted data file, you should delete it from the data directory and
then call `garage repair blocks` on the node to ensure that it
re-obtains a copy from another node on the network.

#### `use_local_tz` (since `v1.1.0`) {#use_local_tz}

By default, Garage runs the lifecycle worker every day at midnight in
UTC. Set the `use_local_tz` configuration value to `true` if you want
Garage to run the lifecycle worker at midnight in your local timezone.
If you have multiple nodes, you should also ensure that each node has
the same timezone configuration.

#### `block_size`

Garage splits stored objects in consecutive chunks of size `block_size`
(except the last one which might be smaller). The default size is 1MiB
and should work in most cases. We recommend increasing it to e.g. 10MiB
if you are using Garage to store large files and have fast network
connections between all nodes (e.g. 1gbps).

If you are interested in tuning this, feel free to do so (and remember
to report your findings to us!). When this value is changed for a
running Garage installation, only files newly uploaded will be affected.
Previously uploaded files will remain available. This however means that
chunks from existing files will not be deduplicated with chunks from
newly uploaded files, meaning you might use more storage space that is
optimally possible.

#### `block_ram_buffer_max` (since `v0.9.4`) {#block_ram_buffer_max}

A limit on the total size of data blocks kept in RAM by S3 API nodes
awaiting to be sent to storage nodes asynchronously.

Explanation: since Garage wants to tolerate node failures, it uses
quorum writes to send data blocks to storage nodes: try to write the
block to three nodes, and return ok as soon as two writes complete. So
even if all three nodes are online, the third write always completes
asynchronously. In general, there are not many writes to a cluster, and
the third asynchronous write can terminate early enough so as to not
cause unbounded RAM growth. However, if the S3 API node is continuously
receiving large quantities of data and the third node is never able to
catch up, many data blocks will be kept buffered in RAM as they are
awaiting transfer to the third node.

The `block_ram_buffer_max` sets a limit to the size of buffers that can
be kept in RAM in this process. When the limit is reached, backpressure
is applied back to the S3 client.

Note that this only counts buffers that have arrived to a certain stage
of processing (received from the client + encrypted and/or compressed as
necessary) and are ready to send to the storage nodes. Many other
buffers will not be counted and this is not a hard limit on RAM
consumption. In particular, if many clients send requests simultaneously
with large objects, the RAM consumption will always grow linearly with
the number of concurrent requests, as each request will use a few
buffers of size `block_size` for receiving and intermediate processing
before even trying to send the data to the storage node.

The default value is 256MiB.

#### `block_max_concurrent_reads` (since `v1.3.0` / `v2.1.0`) {#block_max_concurrent_reads}

The maximum number of blocks (individual files in the data directory)
open simultaneously for reading.

Reducing this number does not limit the number of data blocks that can
be transferred through the network simultaneously. This mechanism was
just added as a backpressure mechanism for HDD read speed: it helps
avoid a situation where too many requests are coming in and Garage is
reading too many block files simultaneously, thus not making timely
progress on any of the reads.

When a request to read a data block comes in through the network, the
requests awaits for one of the `block_max_concurrent_reads` slots to be
available (internally implemented using a Semaphore object). Once it
acquired a read slot, it reads the entire block file to RAM and frees
the slot as soon as the block file is finished reading. Only after the
slot is released will the block\'s data start being transferred over the
network. If the request fails to acquire a reading slot wihtin 15
seconds, it fails with a timeout error. Timeout events can be monitored
through the `block_read_semaphore_timeouts` metric in Prometheus: a
non-zero number of such events indicates an I/O bottleneck on HDD read
speed.

#### `lmdb_map_size`

This parameters can be used to set the map size used by LMDB, which is
the size of the virtual memory region used for mapping the database
file. The value of this parameter is the maximum size the metadata
database can take. This value is not bound by the physical RAM size of
the machine running Garage. If not specified, it defaults to 1GiB on
32-bit machines and 1TiB on 64-bit machines.

#### `compression_level`

Zstd compression level to use for storing blocks.

Values between `1` (faster compression) and `19` (smaller file) are
standard compression levels for zstd. From `20` to `22`, compression
levels are referred as \"ultra\" and must be used with extra care as it
will use lot of memory. A value of `0` will let zstd choose a default
value (currently `3`). Finally, zstd has also compression designed to be
faster than default compression levels, they range from `-1` (smaller
file) to `-99` (faster compression).

If you do not specify a `compression_level` entry, Garage will set it to
`1` for you. With this parameters, zstd consumes low amount of cpu and
should work faster than line speed in most situations, while saving some
space and intra-cluster bandwidth.

If you want to totally deactivate zstd in Garage, you can pass the
special value `'none'`. No zstd related code will be called, your chunks
will be stored on disk without any processing.

Compression is done synchronously, setting a value too high will add
latency to write queries.

This value can be different between nodes, compression is done by the
node which receive the API call.

#### `rpc_secret`, `rpc_secret_file` or `GARAGE_RPC_SECRET`, `GARAGE_RPC_SECRET_FILE` (env) {#rpc_secret}

Garage uses a secret key, called an RPC secret, that is shared between
all nodes of the cluster in order to identify these nodes and allow them
to communicate together. The RPC secret is a 32-byte hex-encoded random
string, which can be generated with a command such as
`openssl rand -hex 32`.

The RPC secret should be specified in the `rpc_secret` configuration
variable. Since Garage `v0.8.2`, the RPC secret can also be stored in a
file whose path is given in the configuration variable
`rpc_secret_file`, or specified as an environment variable
`GARAGE_RPC_SECRET`.

Since Garage `v0.8.5` and `v0.9.1`, you can also specify the path of a
file storing the secret as the `GARAGE_RPC_SECRET_FILE` environment
variable.

#### `rpc_bind_addr`

The address and port on which to bind for inter-cluster communcations
(reffered to as RPC for remote procedure calls). The port specified here
should be the same one that other nodes will used to contact the node,
even in the case of a NAT: the NAT should be configured to forward the
external port number to the same internal port nubmer. This means that
if you have several nodes running behind a NAT, they should each use a
different RPC port number.

#### `rpc_bind_outgoing` (since `v0.9.2`) {#rpc_bind_outgoing}

If enabled, pre-bind all sockets for outgoing connections to the same IP
address used for listening (the IP address specified in `rpc_bind_addr`)
before trying to connect to remote nodes. This can be necessary if a
node has multiple IP addresses, but only one is allowed or able to reach
the other nodes, for instance due to firewall rules or specific routing
configuration.

Disabled by default.

#### `rpc_public_addr`

The address and port that other nodes need to use to contact this node
for RPC calls. **This parameter is optional but recommended.** In case
you have a NAT that binds the RPC port to a port that is different on
your public IP, this field might help making it work.

#### `rpc_public_addr_subnet`

In case `rpc_public_addr` is not set, but autodiscovery is used, this
allows filtering the list of automatically discovered IPs to a specific
subnet.

For example, if nodes should pick *their* IP inside a specific subnet,
but you don\'t want to explicitly write the IP down (as it\'s dynamic,
or you want to share configs across nodes), you can use this option.

#### `bootstrap_peers`

A list of peer identifiers on which to contact other Garage peers of
this cluster. These peer identifiers have the following syntax:

``` {style="background-color:#2b303b;color:#c0c5ce;"}
<node public key>@<node public IP or hostname>:<port>
```

In the case where `rpc_public_addr` is correctly specified in the
configuration file, the full identifier of a node including IP and port
can be obtained by running `garage node id` and then included directly
in the `bootstrap_peers` list of other nodes. Otherwise, only the
node\'s public key will be returned by `garage node id` and you will
have to add the IP yourself.

#### `allow_world_readable_secrets` or `GARAGE_ALLOW_WORLD_READABLE_SECRETS` (env) {#allow_world_readable_secrets}

Garage checks the permissions of your secret files to make sure they\'re
not world-readable. In some cases, the check might fail and consider
your files as world-readable even if they\'re not, for instance when
using Posix ACLs.

Setting `allow_world_readable_secrets` to `true` bypass this permission
verification.

Alternatively, you can set the `GARAGE_ALLOW_WORLD_READABLE_SECRETS`
environment variable to `true` to bypass the permissions check.

#### `allow_punycode`

Allow creating buckets with names containing punycode. When used for
buckets served as websites, this allows using almost any unicode
character in the domain name.

Default to `false`.

### The `[consul_discovery]` section {#the-consul-discovery-section}

Garage supports discovering other nodes of the cluster using Consul. For
this to work correctly, nodes need to know their IP address by which
they can be reached by other nodes of the cluster, which should be set
in `rpc_public_addr`.

#### `consul_http_addr`

The `consul_http_addr` parameter should be set to the full HTTP(S)
address of the Consul server.

#### `api` {#consul_api}

Two APIs for service registration are supported: `catalog` and `agent`.
`catalog`, the default, will register a service using the `/v1/catalog`
endpoints, enabling mTLS if `client_cert` and `client_key` are provided.
The `agent` API uses the `v1/agent` endpoints instead, where an optional
`token` may be provided.

#### `service_name` {#consul_service_name}

`service_name` should be set to the service name under which Garage\'s
RPC ports are announced.

#### `client_cert`, `client_key` {#consul_client_cert_and_key}

TLS client certificate and client key to use when communicating with
Consul over TLS. Both are mandatory when doing so. Only available when
`api = "catalog"`.

#### `ca_cert` {#consul_ca_cert}

TLS CA certificate to use when communicating with Consul over TLS.

#### `tls_skip_verify` {#consul_tls_skip_verify}

Skip server hostname verification in TLS handshake. `ca_cert` is ignored
when this is set.

#### `token` {#consul_token}

Uses the provided token for communication with Consul. Only available
when `api = "agent"`. The policy assigned to this token should at least
have these rules:

``` {.language-hcl data-lang="hcl" style="background-color:#2b303b;color:#c0c5ce;"}
// the `service_name` specified above
service "garage" {
  policy = "write"
}

service_prefix "" {
  policy = "read"
}

node_prefix "" {
  policy = "read"
}
```

#### `tags` and `meta` {#consul_tags_and_meta}

Additional list of tags and map of service meta to add during service
registration.

### The `[kubernetes_discovery]` section {#the-kubernetes-discovery-section}

Garage supports discovering other nodes of the cluster using kubernetes
custom resources. For this to work, a `[kubernetes_discovery]` section
must be present with at least the `namespace` and `service_name`
parameters.

#### `namespace` {#kube_namespace}

`namespace` sets the namespace in which the custom resources are
configured.

#### `service_name` {#kube_service_name}

`service_name` is added as a label to the advertised resources to filter
them, to allow for multiple deployments in a single namespace.

#### `skip_crd` {#kube_skip_crd}

`skip_crd` can be set to true to disable the automatic creation and
patching of the `garagenodes.deuxfleurs.fr` CRD. You will need to create
the CRD manually.

### The `[s3_api]` section {#the-s3-api-section}

#### `api_bind_addr` {#s3_api_bind_addr}

The IP and port on which to bind for accepting S3 API calls. This
endpoint does not suport TLS: a reverse proxy should be used to provide
it.

Alternatively, since `v0.8.5`, a path can be used to create a unix
socket with 0222 mode.

#### `s3_region`

Garage will accept S3 API calls that are targetted to the S3 region
defined here. API calls targetted to other regions will fail with a
AuthorizationHeaderMalformed error message that redirects the client to
the correct region.

#### `root_domain` {#s3_root_domain}

The optional suffix to access bucket using vhost-style in addition to
path-style request. Note path-style requests are always enabled, whether
or not vhost-style is configured. Configuring vhost-style S3 required a
wildcard DNS entry, and possibly a wildcard TLS certificate, but might
be required by softwares not supporting path-style requests.

If `root_domain` is `s3.garage.eu`, a bucket called `my-bucket` can be
interacted with using the hostname `my-bucket.s3.garage.eu`.

### The `[s3_web]` section {#the-s3-web-section}

Garage allows to publish content of buckets as websites. This section
configures the behaviour of this module.

#### `bind_addr` {#web_bind_addr}

The IP and port on which to bind for accepting HTTP requests to buckets
configured for website access. This endpoint does not suport TLS: a
reverse proxy should be used to provide it.

Alternatively, since `v0.8.5`, a path can be used to create a unix
socket with 0222 mode.

#### `root_domain` {#web_root_domain}

The optional suffix appended to bucket names for the corresponding HTTP
Host.

For instance, if `root_domain` is `web.garage.eu`, a bucket called
`deuxfleurs.fr` will be accessible either with hostname
`deuxfleurs.fr.web.garage.eu` or with hostname `deuxfleurs.fr`.

#### `add_host_to_metrics` {#web_add_host_to_metrics}

Whether to include the requested domain name (HTTP `Host` header) in the
Prometheus metrics of the web endpoint. This is disabled by default as
the number of possible values is not bounded and can be a source of
cardinality explosion in the exported metrics.

### The `[admin]` section

Garage has a few administration capabilities, in particular to allow
remote monitoring. These features are detailed below.

#### `api_bind_addr` {#admin_api_bind_addr}

If specified, Garage will bind an HTTP server to this port and address,
on which it will listen to requests for administration features. See
[administration API
reference](https://garagehq.deuxfleurs.fr/documentation/reference-manual/admin-api/)
to learn more about these features.

Alternatively, since `v0.8.5`, a path can be used to create a unix
socket. Note that for security reasons, the socket will have 0220 mode.
Make sure to set user and group permissions accordingly.

#### `admin_token`, `admin_token_file` or `GARAGE_ADMIN_TOKEN`, `GARAGE_ADMIN_TOKEN_FILE` (env) {#admin_token}

The token for accessing all administration functions on the admin
endpoint, with the exception of the metrics endpoint (see
`metrics_token`).

You can use any random string for this value. We recommend generating a
random token with `openssl rand -base64 32`.

For Garage version earlier than `v2.0`, if this token is not set, access
to these endpoints is disabled entirely.

Since Garage `v2.0`, additional admin API tokens can be defined
dynamically in your Garage cluster using administration commands. This
new admin token system is more flexible since it allows admin tokens to
have an expiration date, and to have a scope restricted to certain admin
API functions. If `admin_token` is set, it behaves as an admin token
without expiration and with full scope. Otherwise, only admin API tokens
defined dynamically can be used.

`admin_token` was introduced in Garage `v0.7.2`. `admin_token_file` and
the `GARAGE_ADMIN_TOKEN` environment variable are supported since Garage
`v0.8.2`.

`GARAGE_ADMIN_TOKEN_FILE` is supported since `v0.8.5` / `v0.9.1`.

#### `metrics_token`, `metrics_token_file` or `GARAGE_METRICS_TOKEN`, `GARAGE_METRICS_TOKEN_FILE` (env) {#admin_metrics_token}

The token for accessing the Prometheus metrics endpoint (`/metrics`). If
this token is not set, and unless `metrics_require_token` is set to
`true`, the metrics endpoint can be accessed without access control.

You can use any random string for this value. We recommend generating a
random token with `openssl rand -base64 32`.

`metrics_token` was introduced in Garage `v0.7.2`. `metrics_token_file`
and the `GARAGE_METRICS_TOKEN` environment variable are supported since
Garage `v0.8.2`.

`GARAGE_METRICS_TOKEN_FILE` is supported since `v0.8.5` / `v0.9.1`.

#### `metrics_require_token` (since `v2.0.0`) {#admin_metrics_require_token}

If this is set to `true`, accessing the metrics endpoint will always
require an access token. Valid tokens include the `metrics_token` if it
is set, and admin API token defined dynamicaly in Garage which have the
`Metrics` endpoint in their scope.

#### `trace_sink` {#admin_trace_sink}

Optionally, the address of an OpenTelemetry collector. If specified,
Garage will send traces in the OpenTelemetry format to this endpoint.
These trace allow to inspect Garage\'s operation when it handles S3 API
requests.
:::
::::::

::: {.w-full .flex .items-center .justify-center .py-1.5 .bg-gray-200 .rounded-tl-lg}
[Page content]{.uppercase .tracking-wide .text-xs .text-garage-gray}
:::

1.  [Full
    example](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#full-example){.font-semibold
    .text-gray-800 .transition-all .hover:text-garage-orange}
2.  [Available configuration
    options](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#available-configuration-options){.font-semibold
    .text-gray-800 .transition-all .hover:text-garage-orange}
    - [Index](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#index){#link-index
      .toc .text-gray-700 .hover:text-garage-orange}
    - [Environment
      variables](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#env_variables){#link-env_variables
      .toc .text-gray-700 .hover:text-garage-orange}
    - [Top-level configuration
      options](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#top-level-configuration-options){#link-top-level-configuration-options
      .toc .text-gray-700 .hover:text-garage-orange}
    - [The \[consul_discovery\]
      section](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#the-consul-discovery-section){#link-the-consul-discovery-section
      .toc .text-gray-700 .hover:text-garage-orange}
    - [The \[kubernetes_discovery\]
      section](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#the-kubernetes-discovery-section){#link-the-kubernetes-discovery-section
      .toc .text-gray-700 .hover:text-garage-orange}
    - [The \[s3_api\]
      section](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#the-s3-api-section){#link-the-s3-api-section
      .toc .text-gray-700 .hover:text-garage-orange}
    - [The \[s3_web\]
      section](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#the-s3-web-section){#link-the-s3-web-section
      .toc .text-gray-700 .hover:text-garage-orange}
    - [The \[admin\]
      section](https://garagehq.deuxfleurs.fr/documentation/reference-manual/configuration/#the-admin-section){#link-the-admin-section
      .toc .text-gray-700 .hover:text-garage-orange}

::::::: {.bg-gray-100 .rounded-bl-lg}
:::::: {.section .w-full}
::::: mx-auto
::: {.w-full .flex .items-center .justify-center .py-1.5 .bg-gray-200}
[Navigation]{.uppercase .tracking-wide .text-xs .text-garage-gray}
:::

::: {.w-1/2 .lg:w-1/3}
[[
![](data:image/svg+xml;base64,PHN2ZyBjbGFzcz0idy02IGgtNiBteC1hdXRvIiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgdmlld2JveD0iMCAwIDI0IDI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cGF0aCBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMiIgZD0iTTcgMTZsLTQtNG0wIDBsNC00bS00IDRoMTgiIC8+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zdmc+){.w-6
.h-6 .mx-auto} [Reference Manual]{.mt-0.5 .2xl:hidden}
]{.icon}](https://garagehq.deuxfleurs.fr/documentation/reference-manual/ "Reference Manual"){.flex
.items-center .justify-center .space-x-1 .text-garage-gray .text-sm
.bg-white .hover:bg-garage-gray .hover:bg-opacity-20 .transition .border
.border-garage-orange .p-2.5 .rounded-2xl}
:::
:::::
::::::
:::::::
:::::::::::::

::::::: 2xl:hidden
:::::: {.section .w-full}
::::: mx-auto
::: {.w-full .flex .items-center .justify-center .py-1.5 .bg-gray-200}
[Navigation]{.uppercase .tracking-wide .text-xs .text-garage-gray}
:::

::: {.w-1/2 .lg:w-1/3}
[[
![](data:image/svg+xml;base64,PHN2ZyBjbGFzcz0idy02IGgtNiBteC1hdXRvIiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgdmlld2JveD0iMCAwIDI0IDI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cGF0aCBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMiIgZD0iTTcgMTZsLTQtNG0wIDBsNC00bS00IDRoMTgiIC8+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zdmc+){.w-6
.h-6 .mx-auto} [Reference Manual]{.mt-0.5 .2xl:hidden}
]{.icon}](https://garagehq.deuxfleurs.fr/documentation/reference-manual/ "Reference Manual"){.flex
.items-center .justify-center .space-x-1 .text-garage-gray .text-sm
.bg-white .hover:bg-garage-gray .hover:bg-opacity-20 .transition .border
.border-garage-orange .p-2.5 .rounded-2xl}
:::
:::::
::::::
:::::::
:::::::::::::::::::

:::::::::: {#search-modal .section .modal .hidden .z-50 .bg-gradient-to-b .from-gray-50 .to-gray-100 .w-5/6 .md:w-4/5 .lg:w-3/4 .xl:w-2/3 .2xl:w-1/2 .absolute .top-20 .left-1/2 .transform .-translate-x-1/2 .shadow-2xl .rounded-lg}
::::::::: {.p-2 .md:p-4 .xl:p-8 .border-8 .border-gray-300 .rounded-lg .shadow-inner style="min-height:30vh;"}
:::::::: {.section .relative .flex .flex-col .items-center .justify-center}
::: {.flexs .items-center .justify-center}
[Search]{.text-xl .inline-block .font-thin} [(alt + S)]{.font-normal
.inline-block .text-xs .text-gray-500}
:::

:::: {.field .mt-8 .md:mt-0 .mb-2}
::: control
:::
::::

:::: {.search-results .hidden .mt-8 .p-2 .md:p-4 .w-full .bg-white .rounded .shadow}
::: {.search-results__items .max-h-96 .overflow-y-scroll .p-2 .md:p-4 .focus:outline .outline-garage-orange}
:::
::::
::::::::

[![](data:image/svg+xml;base64,PHN2ZyBpZD0iY2xvc2UtbW9kYWwtYnRuLWljb24iIGNsYXNzPSJ3LTYgaC02IHRleHQtZ3JheS00MDAiIGZpbGw9Im5vbmUiIHN0cm9rZT0iY3VycmVudENvbG9yIiB2aWV3Ym94PSIwIDAgMjQgMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgICAgICAgICAgICAgICA8cGF0aCBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMiIgZD0iTTYgMThMMTggNk02IDZsMTIgMTIiIC8+CiAgICAgICAgICAgIDwvc3ZnPg==){#close-modal-btn-icon
.w-6 .h-6 .text-gray-400}
[(Esc)]{.small}](javascript:closeSearchModal()){#close-modal-btn
.absolute .top-4 .right-4 .flex .items-center .group .rounded-full
.shadow-inner .bg-gray-300 .border .border-transparent
.hover:border-gray-500 .bg-opacity-50 .p-2 aria-label="close"
type="button"}
:::::::::
::::::::::

::: {.content .has-text-centered .flex .flex-col .items-center .justify-center}
[[ ![](https://garagehq.deuxfleurs.fr/icons/git.svg){width="24"} ]{.h-10
.w-10 .bg-white .hover:shadow-xl .rounded-full .shadow .flex
.items-center .justify-center
title="Git"}](https://git.deuxfleurs.fr/Deuxfleurs/garage){target="_blank"}
[[ ![](https://garagehq.deuxfleurs.fr/icons/contact.svg){width="24"}
]{.h-10 .w-10 .bg-white .hover:shadow-xl .rounded-full .shadow .flex
.items-center .justify-center
title="Contact"}](mailto:garagehq@deuxfleurs.fr){target="_blank"}

Built with [Zola](https://www.getzola.org){.font-semibold
.hover:text-garage-orange target="_blank"}, powered by
[Garage](https://garagehq.deuxfleurs.fr){.font-semibold
.hover:text-garage-orange}, hosted by
[Deuxfleurs](https://deuxfleurs.fr){.font-semibold
.hover:text-garage-orange target="_blank"}
:::
